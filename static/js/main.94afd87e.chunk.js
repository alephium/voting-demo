(this["webpackJsonpvoting-app"]=this["webpackJsonpvoting-app"]||[]).push([[0],{244:function(e,t,n){},26:function(e,t,n){"use strict";(function(e){function r(e){e.catch((function(e){void 0!=e&&void 0!=e.error&&void 0!=e.error.detail?alert(e.error.detail):alert(e)}))}function c(e,t){return"Confirmed"==e.type&&(clearInterval(t),!0)}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return i}));var a=function(e){return""!==e};function o(t){return e.from(t).toString("hex")}function i(t){return e.from(t,"hex").toString()}}).call(this,n(20).Buffer)},261:function(e,t){},318:function(e,t){},319:function(e,t){},344:function(e,t){},346:function(e,t){},357:function(e,t){},359:function(e,t){},415:function(e,t){},416:function(e,t){},434:function(e,t,n){"use strict";n.r(t);var r,c,a,o,i=n(3),s=n.n(i),u=n(117),l=n.n(u),d=(n(244),n(16)),p=n(0),b=n.n(p),x=n(1),j=n(120),f=n(10),h=n(40),v=n(232),g=n.n(v),O=n.p+"static/media/alephium-logo-gradient-stroke.be7cb67e.svg",m=n(17),C=n(23),k=n(47),w=n(63),y=m.a.div(r||(r=Object(d.a)(["\n  text-decoration: none;\n  color: rgba(0, 0, 0, 0.9);\n  cursor: pointer;\n  padding: 1.2rem 1.6rem;\n  font-weight: 700;\n  margin: 1rem 0rem;\n  border-radius: 12px;\n  box-shadow: -6px -6px 12px 0 rgb(255 255 255 / 60%), 6px 6px 12px 0 rgb(0 0 0 / 7%);\n  text-align: center;\n\n  & > * {\n    text-decoration: none;\n    color: rgba(0, 0, 0, 0.9);\n  }\n\n  &:hover {\n  }\n\n  &:active {\n    box-shadow: -6px -6px 12px 0 rgb(255 255 255 / 60%) inset, 6px 6px 12px 0 rgb(0 0 0 / 7%) inset;\n  }\n"]))),S=m.a.div(c||(c=Object(d.a)(["\n  display: flex;\n  flex-direction: column;\n  width: calc(100% - 3.2rem);\n  text-decoration: none;\n  color: rgba(0, 0, 0, 0.9);\n  cursor: pointer;\n  padding: 1.2rem 1.6rem;\n  font-weight: 700;\n  margin: 2rem;\n  border-radius: 12px;\n  box-shadow: -6px -6px 12px 0 rgb(255 255 255 / 60%), 6px 6px 12px 0 rgb(0 0 0 / 7%);\n"]))),T=n(2),I=function(e){var t=e.id,n=e.placeholder,r=e.value,c=e.onChange,a=e.type;return Object(T.jsx)(A,{children:Object(T.jsx)(N,{id:t,placeholder:n,value:r,type:a||"text",onChange:function(e){return c(e)}})})},A=m.a.div(a||(a=Object(d.a)(["\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 5px;\n  flex-grow: 1;\n\n  text-decoration: none;\n  color: rgba(0, 0, 0, 0.9);\n  cursor: pointer;\n  padding: 1.2rem 1.6rem;\n  font-weight: 700;\n  margin: 1rem 0rem;\n  border-radius: 12px;\n  box-shadow: 6px 6px 12px 0 rgb(255 255 255 / 60%), -6px -6px 12px 0 rgb(0 0 0 / 7%);\n"]))),N=m.a.input(o||(o=Object(d.a)(["\n  font-weight: 600;\n  border: none;\n  outline: none;\n  background-color: transparent;\n  transition: all 0.15s ease-out 0s;\n  margin-top: auto;\n  margin-bottom: auto;\n\n  &:-webkit-autofill,\n  &:-webkit-autofill:hover,\n  &:-webkit-autofill:focus,\n  &:-webkit-autofill:active {\n    transition: background-color 600000s 0s, color 600000s 0s;\n  }\n\n  &:active {\n    background-color: transparent;\n  }\n"]))),R=n(26),E="50000000000000";function U(e){for(var t=[],n=0;n<e;n++)t.push("transferAlph!(admin, voters[".concat(n,"], ").concat(E,")")),t.push("transferTokenFromSelf!(voters[".concat(n,"], selfTokenId!(), 1)"));return"\n   TxContract Voting(\n     title: ByteVec,\n     mut yes: U256,\n     mut no: U256,\n     mut isClosed: Bool,\n     mut initialized: Bool,\n     admin: Address,\n     voters: [Address; ".concat(e,"]\n   ) {\n     pub payable fn allocateTokens() -> () {\n        assert!(initialized == false)\n        assert!(txCaller!(txCallerSize!() - 1) == admin)\n        ").concat(t.join("\n"),"\n        yes = 0\n        no = 0\n        initialized = true\n     }\n\n     pub payable fn vote(choice: Bool, voter: Address) -> () {\n       assert!(initialized == true && isClosed == false)\n       transferAlph!(voter, admin, ").concat(E,")\n       transferTokenToSelf!(voter, selfTokenId!(), 1)\n       if (choice == true) {\n          yes = yes + 1\n       } else {\n          no = no + 1\n       }\n     }\n\n      pub fn close() -> () {\n        assert!(initialized == true && isClosed == false)\n        assert!(txCaller!(txCallerSize!() - 1) == admin)\n        isClosed = true\n      }\n    }")}function P(e,t,n){return"TxScript VotingScript {\n      pub payable fn main() -> () {\n        let caller = txCaller!(0)\n        let voting = Voting(#".concat(t.tokenId,")\n        approveToken!(caller, #").concat(t.tokenId,", 1)\n        approveAlph!(caller, ").concat(E,")\n        voting.vote(").concat(e,", caller)\n      }\n    }\n    ").concat(U(n),"\n    ")}function V(e,t){return"TxScript TokenAllocation {\n    pub payable fn main() -> () {\n      let voting = Voting(#".concat(e.tokenId,")\n      let caller = txCaller!(0)\n      approveAlph!(caller, ").concat(E," * ").concat(t,")\n      voting.allocateTokens()\n    }\n  }\n  ").concat(U(t),"\n  ")}function B(e,t){return"TxScript ClosingScript {\n    pub payable fn main() -> () {\n      let voting = Voting(#".concat(e.tokenId,")\n      voting.close()\n    }\n  }\n  ").concat(U(t),"\n  ")}function G(e,t,n){return console.log(n),[{type:"ByteVec",value:"".concat(Object(R.e)(e))},{type:"U256",value:"0"},{type:"U256",value:"0"},{type:"Bool",value:!1},{type:"Bool",value:!1},{type:"Address",value:"".concat(t)},{type:"Array",value:n.map((function(e){return{type:"Address",value:"".concat(e)}}))}]}var D,L,z=n(5),H=n(12),M=n(73);function F(){var e=function(){var e=window.localStorage.getItem("voting-demo-settings");return e?JSON.parse(e):null}();return e||{network:"testnet",nodeHost:"http://127.0.0.1:12973",explorerURL:"https://testnet.alephium.org"}}!function(e){e[e.Allocate=0]="Allocate",e[e.Close=1]="Close"}(D||(D={})),function(e){e[e.MAINNET=0]="MAINNET",e[e.TESTNET=1]="TESTNET",e[e.UNKNOWN=2]="UNKNOWN",e[e.UNREACHABLE=3]="UNREACHABLE"}(L||(L={}));var W,q,_,K,J,Y,Q,X,Z,$,ee,te=8e4,ne=function(){function e(t,n,r){var c=this;Object(z.a)(this,e),this.api=void 0,this.walletConnect=void 0,this.provider=void 0,this.accounts=void 0,this.settings=void 0,this.fetch=function(){var e=Object(x.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(!(n=e.sent).error){e.next=5;break}return e.abrupt("return",Promise.reject(new Error(n.error.detail)));case 5:return e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getContractRef=function(){var e=Object(x.a)(b.a.mark((function e(t){var n,r,a,o,i,s,u;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.fetch(c.api.transactions.getTransactionsStatus({txId:t}));case 2:if(!("blockHash"in(n=e.sent))){e.next=29;break}return r=n,e.next=7,c.fetch(c.api.blockflow.getBlockflowBlocksBlockHash(r.blockHash));case 7:if(a=e.sent,!(o=a.transactions.find((function(e){return e.unsigned.txId===t})))){e.next=26;break}if(!(i=o.generatedOutputs.find((function(e){return!("locktime"in e)})))){e.next=23;break}if(console.log(i,"output"),s=i.address,u=i.tokens[0].id,console.log(s),!s){e.next=20;break}return e.abrupt("return",{contractAddress:s,tokenId:u});case 20:return e.abrupt("return",Promise.reject("The contract address is undefined"));case 21:e.next=24;break;case 23:return e.abrupt("return",Promise.reject("No token found"));case 24:e.next=27;break;case 26:return e.abrupt("return",Promise.reject("No contract found"));case 27:e.next=30;break;case 29:return e.abrupt("return",Promise.reject("Not confirmed yet"));case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getContractState=function(){var e=Object(x.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.getContractRef(t);case 2:return n=e.sent,e.next=5,c.fetch(c.api.addresses.getAddressesAddressGroup(n.contractAddress));case 5:return r=e.sent,e.abrupt("return",c.fetch(c.api.contracts.getContractsAddressState(n.contractAddress,{group:r.group})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getNVoters=function(){var e=Object(x.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.getContractState(t).then((function(e){return e.fields.length-6})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var a={baseUrl:t};this.api=new M.Api(a),this.accounts=[],this.walletConnect=n,this.provider=r,this.settings=F()}return Object(H.a)(e,[{key:"getActiveAddress",value:function(){var e=Object(x.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.accounts[0]||Promise.reject("No active address"));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deployContract",value:function(){var e=Object(x.a)(b.a.mark((function e(t,n,r,c,a){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.provider.request({method:"alephium_signAndSubmitTx",params:{fromAddress:t,contract:n,gas:r,state:c,issueTokenAmount:a}}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n,r,c,a){return e.apply(this,arguments)}}()},{key:"deployScript",value:function(){var e=Object(x.a)(b.a.mark((function e(t,n,r){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.provider.request({method:"alephium_signAndSubmitTx",params:{fromAddress:t,script:n,gas:r}}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getTxStatus",value:function(){var e=Object(x.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch(this.api.transactions.getTransactionsStatus({txId:t}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getNetworkType",value:function(){var e=Object(x.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.fetch(this.api.infos.getInfosChainParams()).then((function(e){return 0==e.networkId?L.MAINNET:1==e.networkId?L.TESTNET:L.UNKNOWN})));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),re=ne,ce=n(86),ae=m.a.span(W||(W=Object(d.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: ",";\n  margin-bottom: 20px;\n  margin-right: 100px;\n  background-color: ",";\n  width: 100%;\n  height: 50px;\n  border-radius: 12px;\n  box-shadow: 6px 6px 12px 0 rgb(255 255 255 / 60%) inset, -6px -6px 12px 0 rgb(0 0 0 / 7%) inset;\n"])),(function(e){return e.color}),(function(e){return e.backgroundColor})),oe={DANGER:{color:"#721c24",backgroundColor:"#f8d7da"},WARNING:{color:"#7b773e",backgroundColor:"#fff6ad"},SUCCESS:{color:"#1e3d1e",backgroundColor:"lightGreen"}},ie=function(e){var t=e.voters,n=e.removeVoter,r=e.admin;return t.length>0?Object(T.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:"1rem"},children:[Object(T.jsxs)("table",{children:[Object(T.jsx)("thead",{children:Object(T.jsxs)("tr",{children:[Object(T.jsx)("th",{children:"#"}),Object(T.jsx)("th",{children:"Address"}),Object(T.jsx)("th",{children:"Group"}),Object(T.jsx)("th",{})]})}),Object(T.jsx)("tbody",{style:{fontSize:"14px"},children:t.map((function(e,t){return Object(T.jsxs)("tr",{children:[Object(T.jsx)("td",{children:t+1}),Object(T.jsx)("td",{children:e.address}),Object(T.jsx)("td",{children:Object(T.jsx)("span",{style:{color:void 0===r||r&&e.group===r.group?"black":"red"},children:e.group})}),Object(T.jsxs)("td",{children:[" ",Object(T.jsx)(y,{style:{marginLeft:"10px",fontSize:"10px"},onClick:function(){return n(e.address)},children:"\u274c"})]})]},t)}))})]}),r&&t.filter((function(e){return e.group!==r.group})).length>0?Object(T.jsx)("div",{children:Object(T.jsxs)(ae,{color:oe.DANGER.color,backgroundColor:oe.DANGER.backgroundColor,children:["Voters addresses should be in the administrator address Group ",r.group]})}):null]}):null},se=function(e){var t=e.addVoter,n=Object(i.useState)(""),r=Object(f.a)(n,2),c=r[0],a=r[1],o=R.d;return Object(T.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(T.jsx)(I,{id:"voterInput",placeholder:"Please enter a voter address",onChange:function(e){return function(e){a(e.target.value)}(e)},value:c}),Object(T.jsx)(y,{onClick:function(){o(c)?(t(c),a("")):alert("Please enter a valid address")},style:{marginLeft:"1rem"},children:"+"})]})},ue=function(e){var t=e.txStatus,n=e.txId,r=Object(i.useContext)(_e),c=t;return t&&n?"Confirmed"===c.type?Object(T.jsx)(le,{children:Object(T.jsxs)(ae,{color:oe.SUCCESS.color,backgroundColor:oe.SUCCESS.backgroundColor,children:[Object(T.jsx)("a",{href:"".concat(r.settings.explorerURL,"/#/transactions/").concat(n),target:"_blank",rel:"noopener noreferrer",children:"Transaction"}),"\xa0 Confirmed!"]})}):"MemPooled"===c.type?Object(T.jsx)(le,{children:Object(T.jsxs)(ae,{color:oe.WARNING.color,backgroundColor:oe.WARNING.backgroundColor,children:["Pending\xa0",Object(T.jsx)("a",{href:"".concat(r.settings.explorerURL,"/#/transactions/").concat(n),target:"_blank",rel:"noopener noreferrer",children:"transaction."}),"\xa0 Please wait.."]})}):Object(T.jsx)(le,{children:Object(T.jsx)(ae,{color:oe.DANGER.color,backgroundColor:oe.DANGER.backgroundColor,children:"Transaction not found"})}):null},le=m.a.div(q||(q=Object(d.a)(["\n  margin-top: 50px;\n"]))),de=ue,pe=m.a.div(_||(_=Object(d.a)(["\n  display: flex;\n"]))),be=m.a.div(K||(K=Object(d.a)(["\n  color: rgba(0, 0, 0, 0.9);\n  font-weight: 700;\n  margin: 1rem 0rem 1rem 0rem;\n  border-radius: 12px;\n  width: 3.7rem;\n  height: 3.2rem;\n  text-align: center;\n  line-height: 3.2rem;\n"]))),xe=function(){var e=Object(i.useContext)(_e),t=Object(i.useState)([]),n=Object(f.a)(t,2),r=n[0],c=n[1],a=Object(i.useState)(void 0),o=Object(f.a)(a,2),s=o[0],u=o[1],l=Object(i.useState)(e.cache.createTxResult),d=Object(f.a)(l,2),p=d[0],j=d[1],h=Object(i.useState)(void 0),v=Object(f.a)(h,2),g=v[0],O=v[1],m=Object(i.useState)(void 0),C=Object(f.a)(m,2),A=C[0],N=C[1],E=Object(i.useState)(""),P=Object(f.a)(E,2),V=P[0],B=P[1],D=Object(i.useState)(!1),L=Object(f.a)(D,2),z=L[0],H=L[1],M=Object(i.useState)(""),F=Object(f.a)(M,2),W=(F[0],F[1]);function q(e){return{address:e,group:Object(ce.addressToGroup)(e,4)}}var _=function(t,n){var r;null===(r=e.apiClient)||void 0===r||r.getTxStatus(null===n||void 0===n?void 0:n.txId).then((function(r){O(r),N(r),Object(R.b)(r,t)&&e.editCache({currentContractId:n.txId})}))};Object(i.useEffect)((function(){if(p){e.editCache({createTxResult:p});var t=setInterval((function(){_(t,p)}),1e3);return _(t,p),function(){return clearInterval(t)}}}),[p]);var K=function(){var t=Object(x.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.apiClient){t.next=15;break}if(""!=V){t.next=5;break}return t.abrupt("return",Promise.reject("Please provide a title"));case 5:if(void 0!=s){t.next=9;break}return t.abrupt("return",Promise.reject("Please Provide an administrator address"));case 9:return H(!0),t.next=12,e.apiClient.deployContract(e.accounts[0],U(r.length),te,G(V,null===s||void 0===s?void 0:s.address,r.map((function(e){return e.address}))),r.length.toString());case 12:(n=t.sent)&&(W(n.contractAddress),j(n)),H(!1);case 15:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(T.jsxs)(T.Fragment,{children:[g&&(null===p||void 0===p?void 0:p.txId)&&Object(T.jsx)(ue,{txStatus:g,txId:p.txId}),(null===p||void 0===p?void 0:p.txId)&&A&&"Confirmed"==A.type&&Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(y,{children:Object(T.jsx)(k.b,{to:"/administrate/".concat(p.txId),children:"Allocate voting tokens"})}),Object(T.jsx)(y,{onClick:function(){e.editCache({currentContractId:"",createTxResult:void 0,voteTxResult:void 0,administrateTxResult:void 0,administrateAction:void 0}),c([]),u(void 0),B(""),j(void 0),O(void 0),N(void 0)},children:"Create another poll"})]}),!p&&Object(T.jsxs)(S,{children:[Object(T.jsx)(I,{id:"voting-title",placeholder:"Subject to vote on",value:V,onChange:function(e){return B(e.target.value)}}),Object(T.jsxs)(pe,{children:[Object(T.jsx)(I,{id:"admin-address",placeholder:"The administrator address",value:void 0!=s?s.address:"",onChange:function(e){return t=e.target.value,void u(""!=t?q(t):void 0);var t}}),Object(T.jsx)(be,{children:void 0!==s&&""!==s.address&&"G"+s.group})]}),Object(T.jsx)(ie,{voters:r,removeVoter:function(e){var t=r.filter((function(t){return e!=t.address}));c(t)},admin:s}),Object(T.jsx)(se,{addVoter:function(e){r.map((function(e){return e.address})).includes(e)||c([].concat(Object(w.a)(r),[q(e)]))}}),Object(T.jsx)(y,{onClick:function(){return Object(R.a)(K())},children:"Create"}),z&&Object(T.jsx)("div",{children:"Waiting for wallet response..."})]})]})},je=function(e){var t=e.contractTxId,n=Object(i.useContext)(_e),r=Object(i.useState)(""),c=Object(f.a)(r,2),a=c[0],o=c[1],s=Object(i.useState)(""),u=Object(f.a)(s,2),l=u[0],d=u[1],p=Object(i.useState)(""),b=Object(f.a)(p,2),x=b[0],j=b[1];return n.apiClient&&n.apiClient.getContractState(t).then((function(e){var t=Object(R.c)(e.fields[0].value),n=e.fields[1],r=e.fields[2];d(n.value),j(r.value),o(t)})),Object(T.jsxs)(S,{children:[Object(T.jsx)("p",{children:"The vote is already closed, here are the results:"}),Object(T.jsx)("p",{children:a}),Object(T.jsxs)("p",{children:["Yes: ",l]}),Object(T.jsxs)("p",{children:["No: ",x]})]})},fe=function(e){var t=e.contractRef,n=e.contractTxId,r=e.title,c=Object(i.useContext)(_e),a=Object(i.useState)(void 0),o=Object(f.a)(a,2),s=o[0],u=o[1],l=Object(i.useState)(c.cache.voteTxResult),d=Object(f.a)(l,2),p=d[0],j=d[1],h=Object(i.useState)(void 0),v=Object(f.a)(h,2),g=v[0],O=v[1],m=function(e,t){var n;null===(n=c.apiClient)||void 0===n||n.getTxStatus(null===t||void 0===t?void 0:t.txId).then((function(t){u(t),O(t),Object(R.b)(t,e)}))};Object(i.useEffect)((function(){if(p){c.editCache({voteTxResult:p});var e=setInterval((function(){m(e,p)}),1e3);return m(e,p),function(){return clearInterval(e)}}}),[p]);var C=function(){var e=Object(x.a)(b.a.mark((function e(r){var a,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&c.apiClient&&n)){e.next=6;break}return e.next=3,c.apiClient.getNVoters(n);case 3:a=e.sent,o=P(r,t,a),Object(R.a)(c.apiClient.deployScript(c.accounts[0],o,te).then(j));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(T.jsxs)("div",{children:[s&&(null===p||void 0===p?void 0:p.txId)&&Object(T.jsx)(de,{txStatus:s,txId:p.txId}),(null===p||void 0===p?void 0:p.txId)&&g&&"Confirmed"==g.type&&Object(T.jsxs)(S,{style:{maxWidth:"400px",textAlign:"center",lineHeight:"1.5"},children:[Object(T.jsx)("p",{children:"Thanks for voting!"}),Object(T.jsx)("p",{children:"Reload the contract when the administrator has closed the vote to see the results."})]}),!p&&Object(T.jsxs)(S,{children:[Object(T.jsx)("p",{children:r}),Object(T.jsx)(y,{onClick:function(){return C(!0)},children:"Yes"}),Object(T.jsx)(y,{onClick:function(){return C(!1)},children:"No"})]})]})},he=function(){var e=Object(i.useContext)(_e),t=Object(C.f)().txId,n=Object(i.useState)(function(){var n=t||"";return e.cache.currentContractId&&(n=e.cache.currentContractId),n}()),r=Object(f.a)(n,2),c=r[0],a=r[1],o=Object(i.useState)(void 0),s=Object(f.a)(o,2),u=s[0],l=s[1],d=Object(i.useState)(void 0),p=Object(f.a)(d,2),j=p[0],h=p[1],v=Object(i.useState)(""),g=Object(f.a)(v,2),O=g[0],m=g[1],k=function(){var t=Object(x.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.apiClient){t.next=6;break}return e.editCache({currentContractId:c}),t.next=4,e.apiClient.getContractRef(c);case 4:(n=t.sent)&&(h(n),e.apiClient.getContractState(c).then((function(e){var t=e.fields[0].value;m(Object(R.c)(t));var n=e.fields[3].value;l(n)})));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),w=Object(T.jsxs)(S,{children:[Object(T.jsx)(I,{id:"txId",placeholder:"The contract transaction ID",value:c,onChange:function(e){return a(e.target.value)}}),Object(T.jsx)(y,{onClick:function(){return Object(R.a)(k())},children:"Load Contract"})]});return!0===u?e.apiClient&&(w=Object(T.jsx)(je,{contractTxId:c})):!1===u&&(w=Object(T.jsx)(fe,{contractRef:j,contractTxId:e.cache.currentContractId,title:O})),w},ve=function(){var e=Object(C.f)().txId,t=Object(i.useContext)(_e),n=Object(i.useState)(function(){var n=e||"";return t.cache.currentContractId&&(n=t.cache.currentContractId),n}()),r=Object(f.a)(n,2),c=r[0],a=r[1],o=Object(i.useState)(t.cache.administrateTxResult),s=Object(f.a)(o,2),u=s[0],l=s[1],d=Object(i.useState)(void 0),p=Object(f.a)(d,2),j=p[0],h=p[1],v=Object(i.useState)(void 0),g=Object(f.a)(v,2),O=g[0],m=g[1],w=Object(i.useState)(t.cache.administrateAction),A=Object(f.a)(w,2),N=A[0],E=A[1],U=function(e,n){var r;null===(r=t.apiClient)||void 0===r||r.getTxStatus(n.txId).then((function(t){h(t),m(t),Object(R.b)(t,e)}))};Object(i.useEffect)((function(){if(u){t.editCache({administrateTxResult:u});var e=setInterval((function(){U(e,u)}),1e3);return U(e,u),function(){return clearInterval(e)}}}),[u]);var P=function(){var e=Object(x.a)(b.a.mark((function e(){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.apiClient){e.next=12;break}return e.next=3,t.apiClient.getContractRef(c).catch((function(e){return console.log(e)}));case 3:if(!(n=e.sent)){e.next=12;break}return e.next=7,t.apiClient.getNVoters(c);case 7:return r=e.sent,e.next=10,t.apiClient.deployScript(t.accounts[0],V(n,r),te).then(l);case 10:E(D.Allocate),t.editCache({currentContractId:c,administrateAction:D.Allocate});case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=Object(x.a)(b.a.mark((function e(){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.apiClient){e.next=12;break}return e.next=3,t.apiClient.getContractRef(c).catch((function(e){return console.log(e)}));case 3:if(!(n=e.sent)){e.next=12;break}return e.next=7,t.apiClient.getNVoters(c);case 7:return r=e.sent,e.next=10,t.apiClient.deployScript(t.accounts[0],B(n,r),te).then(l);case 10:E(D.Close),t.editCache({currentContractId:c,administrateAction:D.Close});case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(T.jsxs)(T.Fragment,{children:[j&&(null===u||void 0===u?void 0:u.txId)&&Object(T.jsx)(ue,{txStatus:j,txId:u.txId}),(null===u||void 0===u?void 0:u.txId)&&O&&"Confirmed"===O.type&&N===D.Allocate&&Object(T.jsx)(S,{children:Object(T.jsxs)("div",{style:{flexDirection:"row"},children:["Share this",Object(T.jsx)(k.b,{to:"/vote/".concat(c),children:" link "})," to the voters."]})}),(!u||O&&"Confirmed"===O.type)&&Object(T.jsxs)(S,{children:[Object(T.jsx)(I,{id:"tx-id",placeholder:"The contract transaction ID",value:c,onChange:function(e){return a(e.target.value)}}),Object(T.jsx)(y,{onClick:function(){return Object(R.a)(P())},children:"Allocate Tokens"}),Object(T.jsx)(y,{onClick:function(){return Object(R.a)(G())},children:"Close voting"})]})]})},ge=n(237),Oe=n.n(ge),me=n(239);function Ce(){}var ke,we,ye,Se,Te,Ie,Ae,Ne,Re,Ee=m.a.div(J||(J=Object(d.a)(["\n  display: flex;\n  align-items: center;\n  flex-direction: column;\n  margin-top: 2rem;\n\n  background-image: linear-gradient(-140deg, rgb(255, 93, 81), 67%, rgb(18, 0, 218));\n  letter-spacing: 0.02rem;\n  border-radius: 12px;\n  padding: 4rem;\n  box-shadow: 6px 0px 12px 0 rgba(255, 93, 81, 0.6), 0px 6px 12px 0 rgba(18, 0, 218, 0.3);\n"]))),Ue=m.a.h1(Y||(Y=Object(d.a)(["\n  color: rgba(255, 255, 255, 0.84);\n  font-weight: 900;\n  margin-bottom: 2rem;\n"]))),Pe=m.a.p(Q||(Q=Object(d.a)(["\n  color: rgba(255, 255, 255, 0.67);\n  font-weight: 700;\n  padding: 1.5rem 2rem;\n  margin: 1rem;\n  border-radius: 12px;\n  box-shadow: -6px -6px 12px 0 rgba(255, 255, 255, 0.1), 6px 6px 12px 0 rgba(0, 0, 0, 0.1);\n"]))),Ve=m.a.input(X||(X=Object(d.a)(["\n  color: rgba(255, 255, 255, 0.67);\n  font-weight: 700;\n  padding: 1.5rem 2rem;\n  margin: 1rem;\n  background: transparent;\n  border: none;\n  border-radius: 12px;\n  box-shadow: -6px -6px 12px 0 rgba(255, 255, 255, 0.1) inset, 6px 6px 12px 0 rgba(0, 0, 0, 0.1) inset;\n  width: 100%;\n"]))),Be=Object(m.a)(Oe.a)(Z||(Z=Object(d.a)(["\n  width: 600px;\n  margin: auto;\n  font-family: Roboto, 'Droid Sans', sans-serif;\n"]))),Ge=m.a.div($||($=Object(d.a)(["\n  display: flex;\n  flex-direction: row;\n"]))),De=m.a.div(ee||(ee=Object(d.a)(["\n  color: rgba(255, 255, 255, 0.7);\n  cursor: pointer;\n  padding: 1.2rem 1.6rem;\n  font-weight: 700;\n  margin: 1rem;\n  border-radius: 12px;\n  box-shadow: 6px 6px 12px 0 rgba(255, 255, 255, 0.1) inset, -6px -6px 12px 0 rgba(0, 0, 0, 0.1) inset;\n"]))),Le=function(e){var t=e.isModalOpen,n=e.onUnlock,r=e.uri,c=Object(i.useState)("network select"),a=Object(f.a)(c,2),o=a[0],s=a[1];return Object(i.useEffect)((function(){s(void 0!==r?"pairing":"network select")}),[r]),Object(T.jsx)(Be,{isOpen:t,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,onRequestClose:Ce,ariaHideApp:!1,children:Object(T.jsxs)(Ee,{children:[Object(T.jsx)(Ue,{children:"This dApp requires an action"}),"network select"==o&&Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(Pe,{children:"Select the network which your wallet is using"}),Object(T.jsxs)(Ge,{children:[Object(T.jsx)(De,{onClick:function(){return n("mainnet")},children:"Mainnet"}),Object(T.jsx)(De,{onClick:function(){return n("testnet")},children:"Testnet"}),Object(T.jsx)(De,{onClick:function(){return n("localhost")},children:"Localhost"})]})]}),"pairing"==o&&Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(me.a,{value:r||"",size:256,includeMargin:!0}),Object(T.jsx)(Ve,{value:r})]})]})})},ze=n(238),He=function(e){var t=e.networkType;return Object(T.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[Object(T.jsx)(We,{children:function(e){return e===L.MAINNET?"Mainnet":e===L.TESTNET?"Testnet":e===L.UNKNOWN?"Unknown network":"Unreachable node"}(t)}),t!==L.TESTNET&&Object(T.jsx)(Me,{})]})},Me=function(){return Object(T.jsx)(Fe,{children:"\u26a0"})},Fe=m.a.span(ke||(ke=Object(d.a)(["\n  color: red;\n  font-size: 25px;\n  margin-left: 10px;\n"]))),We=m.a.button(we||(we=Object(d.a)(["\n  background-color: white;\n  border-radius: 15px;\n  border-width: 1px;\n  border-style: solid;\n  border-color: #e7e7e7;\n  padding-left: 10px;\n  padding-right: 10px;\n  margin-left: 20px;\n  padding-top: 0px;\n  height: 30px;\n"]))),qe={settings:F(),setSettings:function(){return null},apiClient:void 0,setApiClient:function(){return null},cache:{currentContractId:"",createTxResult:void 0,voteTxResult:void 0,administrateTxResult:void 0,administrateAction:void 0},editCache:function(){return null},accounts:[]},_e=s.a.createContext(qe);Object(ze.getStorage)();function Ke(){}var Je=m.a.img(ye||(ye=Object(d.a)(["\n  width: auto;\n  height: 50px;\n"]))),Ye=m.a.div(Se||(Se=Object(d.a)(["\n  padding-top: 20px;\n  padding-bottom: 20px;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  display: flex;\n  font-family: Arial;\n  width: 39rem;\n"]))),Qe=m.a.nav(Te||(Te=Object(d.a)(["\n  justify-content: space-between;\n  display: flex;\n  flex-direction: row;\n  width: auto;\n  align-items: center;\n  margin-top: 3.5rem;\n  margin-bottom: 0rem;\n"]))),Xe=m.a.nav(Ie||(Ie=Object(d.a)(["\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n  display: flex;\n  color: rgba(0, 0, 0, 0.9);\n  cursor: pointer;\n  font-weight: 700;\n  width: 100%;\n  border-radius: 12px;\n  box-shadow: 6px 6px 12px 0 rgb(255 255 255 / 80%), -6px -6px 19px 0 rgb(0 0 0 / 15%);\n"]))),Ze=Object(m.a)(k.b)(Ae||(Ae=Object(d.a)(["\n  text-decoration: none;\n  color: rgba(0, 0, 0, 0.9);\n  cursor: pointer;\n  padding: 1.2rem 1.6rem;\n  font-weight: 700;\n  margin: 0.4rem;\n  border-radius: 12px;\n  box-shadow: -6px -6px 12px 0 rgb(255 255 255 / 60%), 6px 6px 12px 0 rgb(0 0 0 / 7%);\n"]))),$e=m.a.div(Ne||(Ne=Object(d.a)(["\n  color: rgb(255 255 255 / 88%);\n  background-color: rgb(255 0 0);\n  line-height: 2.3rem;\n  width: 2.3rem;\n  text-align: center;\n  height: 2.3rem;\n  cursor: pointer;\n  font-weight: 700;\n  margin: 1rem;\n  border-radius: 12px;\n  box-shadow: -7px -7px 20px 0 rgb(0 0 0 / 36%) inset, 7px 7px 24px 0 rgb(255 104 76 / 87%) inset,\n    -2px -2px 24px 0 rgb(255 104 76 / 87%);\n\n  &:active {\n    box-shadow: 7px 7px 20px 0 rgb(0 0 0 / 36%) inset, -7px -7px 24px 0 rgb(255 104 76 / 87%) inset;\n  }\n"]))),et=m.a.div(Re||(Re=Object(d.a)(["\n  width: 10rem;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  font-weight: 600;\n  position: fixed;\n  right: 1rem;\n  top: 1rem;\n"]))),tt=function(){var e=Object(i.useState)(!0),t=Object(f.a)(e,2),n=t[0],r=t[1],c=Object(i.useState)(void 0),a=Object(f.a)(c,2),o=a[0],s=a[1],u=Object(i.useState)(F()),l=Object(f.a)(u,2),d=l[0],p=l[1],v=Object(i.useState)(void 0),m=Object(f.a)(v,2),k=m[0],w=m[1],y=Object(i.useReducer)((function(e,t){return Object(j.a)(Object(j.a)({},e),t)}),{currentContractId:"",createTxResult:void 0,voteTxResult:void 0,administrateTxResult:void 0,administrateAction:void 0}),S=Object(f.a)(y,2),I=S[0],A=S[1],N=Object(i.useState)(void 0),R=Object(f.a)(N,1)[0],E=Object(i.useState)([]),U=Object(f.a)(E,2),P=U[0],V=U[1],B=Object(i.useCallback)(function(){var e=Object(x.a)(b.a.mark((function e(t){var n,c,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.c.init({projectId:"6e2562e43678dd68a9070a62b6d52207",relayUrl:"wss://relay.walletconnect.com",metadata:{name:"Voting demo",description:"A demonstration of voting on Alephium",url:"https://walletconnect.com/",icons:["https://walletconnect.com/walletconnect-logo.png"]}});case 2:return n=e.sent,c=new g.a({chains:[t],client:n}),n.on(h.a.pairing.proposal,function(){var e=Object(x.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.signal.params.uri,s(n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.on(h.a.session.deleted,Ke),n.on(h.a.session.sync,(function(){r(!1),s(void 0)})),c.on("accountsChanged",(function(e){r(!1),s(void 0),V(e)})),e.next=10,c.connect();case 10:return e.next=12,c.request({method:"alephium_getServices",params:{}});case 12:a=e.sent,p({network:t,nodeHost:a.nodeHost,explorerURL:a.explorerUrl}),w(new re(d.nodeHost,n,c)),r(!1);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),G=Object(i.useCallback)(Object(x.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===k||void 0===k?void 0:k.provider.disconnect();case 2:V([]),r(!0);case 4:case"end":return e.stop()}}),e)}))),[k]),D={boxShadow:"-6px -6px 12px 0 rgb(255 255 255 / 60%) inset, 6px 6px 12px 0 rgb(0 0 0 / 7%) inset"};return Object(T.jsx)(_e.Provider,{value:{settings:d,setSettings:p,apiClient:k,setApiClient:w,cache:I,editCache:A,accounts:P},children:Object(T.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(T.jsxs)("div",{style:{position:"fixed",left:"1rem",top:"1rem"},children:[Object(T.jsx)(Je,{src:O}),void 0!==R&&Object(T.jsx)(He,{networkType:R})]}),Object(T.jsxs)(Ye,{children:[Object(T.jsx)(Qe,{children:Object(T.jsxs)(Xe,{children:[Object(T.jsx)(Ze,{exact:!0,to:"/",activeStyle:D,children:"Create"}),Object(T.jsx)(Ze,{to:"/administrate",activeStyle:D,children:"Administrate"}),Object(T.jsx)(Ze,{to:"/vote",activeStyle:D,children:"Vote"}),Object(T.jsx)($e,{onClick:G,children:"\u23fb"})]})}),Object(T.jsx)(et,{children:P[0]}),Object(T.jsxs)(C.c,{children:[Object(T.jsx)(C.a,{exact:!0,path:"/",children:Object(T.jsx)(xe,{})}),Object(T.jsx)(C.a,{exact:!0,path:"/vote/:txId",children:Object(T.jsx)(he,{})}),Object(T.jsx)(C.a,{path:"/vote",children:Object(T.jsx)(he,{})}),Object(T.jsx)(C.a,{exact:!0,path:"/administrate/:txId",children:Object(T.jsx)(ve,{})}),Object(T.jsx)(C.a,{path:"/administrate",children:Object(T.jsx)(ve,{})})]}),Object(T.jsx)(Le,{isModalOpen:n,onUnlock:B,uri:o})]})]})})},nt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,435)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),c(e),a(e),o(e)}))};l.a.render(Object(T.jsx)(s.a.StrictMode,{children:Object(T.jsx)(k.a,{children:Object(T.jsx)(tt,{})})}),document.getElementById("root")),nt()}},[[434,1,2]]]);
//# sourceMappingURL=main.94afd87e.chunk.js.map